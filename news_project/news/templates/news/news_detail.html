{% extends 'news/base.html' %}
{% block title %}{{ news.title }}{% endblock %}

{% block content %}
    <div class="card">
        <div class="card-body">
            <h1 class="card-title">{{ news.title }}</h1>
            {% if news.image %}
                <img src="{{ news.image.url }}" class="img-fluid" alt="News Image">
            {% endif %}
            <p class="card-text">{{ news.text }}</p>
            <p><strong>Tags:</strong> {% for tag in news.tags.all %}{{ tag.name }} {% endfor %}</p>
            <p><strong>Views:</strong> {{ news.views }}</p>

            <button onclick="toggleLike({{ news.id }})" class="btn btn-primary">Like</button>
            <span id="like-count">{{ news.like_set.count }}</span> Likes
        </div>
    </div>

    <script>
        function toggleLike(newsId) {
            fetch(`/api/news/${newsId}/like/`, {
                method: "POST",
                headers: {
                    "Authorization": "Token " + localStorage.getItem("token"),
                    "Content-Type": "application/json"
                }
            }).then(response => response.json())
              .then(data => {
                  document.getElementById("like-count").innerText = data.likes;
              });
        }
    </script>
{% endblock %}
